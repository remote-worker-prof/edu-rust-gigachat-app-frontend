# Учебная инструкция: сборка и запуск UI

Документ рассчитан на студентов, которые только начинают работать с
инструментами разработки. Стиль — академический и пояснительный, с
минимумом «прыжков» между темами.

## 1. Что именно собирается и запускается

Проект состоит из двух частей:

1. **Frontend (UI)** — клиентская часть, которая работает в браузере.
2. **Backend (API‑сервер)** — серверная часть, которая принимает запросы и
   возвращает ответы.

В нашем случае:
- frontend — проект `edu-rust-gigachat-app-frontend`,
- backend — проект `edu-rust-gigachat-app-backend`.

**Важно:** это два **разных процесса**, и запускать их нужно отдельно.
UI **не обращается к GigaChat напрямую** — только к backend‑API.

## 2. Мини‑словарь терминов

### 2.1. Командная строка (терминал)

**Терминал** — окно, в которое вводятся текстовые команды. Команда — это
инструкция, которую выполняет система. Примеры команд показаны в блоках
кода.

### 2.2. Путь к проекту

**Путь** — адрес папки на диске. В командах ниже путь нужно подставлять
свой. Например:

```bash
cd /ваш/путь/к/edu-rust-gigachat-app-frontend
```

Команда `cd` означает «перейти в папку».

### 2.3. HTTP‑сервер, адрес и порт

- **Адрес** (например, `127.0.0.1`) — это компьютер, к которому мы
  обращаемся. `127.0.0.1` означает «текущий компьютер».
- **Порт** — номер, который отличает один сервис от другого на том же
  адресе. Например, `8000` и `8080` — это разные порты.

### 2.4. API

**API** — набор URL‑адресов, по которым frontend может получить данные от
backend. В нашем случае это `/health` и `/ask`.

### 2.5. WebAssembly (WASM)

**WebAssembly** — формат кода, который может выполнять браузер. Rust
компилируется в WASM, чтобы UI работал в браузере.

### 2.6. Target (цель компиляции)

**Target** — платформа, для которой компилируется код. Для браузера нужен
`wasm32-unknown-unknown`.

### 2.7. Trunk

**Trunk** — инструмент, который:
- собирает Rust‑код в WASM,
- подготавливает статические файлы,
- запускает локальный сервер для разработки UI.

### 2.8. Переменные окружения

**Переменная окружения** — параметр, который задаётся перед запуском
команды. В проекте используется `API_BASE_URL`, чтобы указать адрес
backend.

Пример:

```bash
API_BASE_URL=http://127.0.0.1:8000 NO_COLOR=true trunk serve --address 127.0.0.1 --port 8080
```

### 2.9. Затравочная проверка

**Затравочная проверка** — минимальная проверка, которая подтверждает, что
приложение **собирается**, **запускается** и отображает базовый экран.

## 3. Проверка инструментов (что должно быть установлено)

Перед началом убедитесь, что доступны команды:

```bash
rustc --version
cargo --version
rustup --version
```

Если команда «не найдена», значит инструмент не установлен. В таком случае
следует обратиться к преподавателю или инструкции курса.

## 4. Установка компонентов для UI

### 4.1. Установка цели WebAssembly

```bash
rustup target add wasm32-unknown-unknown
```

### 4.2. Установка Trunk

```bash
cargo install trunk
```

## 5. Запуск backend (серверной части)

Откройте **первый терминал** и выполните:

```bash
cd /ваш/путь/к/edu-rust-gigachat-app-backend
cargo run
```

По умолчанию backend доступен по адресу:

```
http://127.0.0.1:8000
```

## 6. Запуск UI (frontend)

Откройте **второй терминал** и выполните:

```bash
cd /ваш/путь/к/edu-rust-gigachat-app-frontend
NO_COLOR=true trunk serve --address 127.0.0.1 --port 8080
```

После запуска откройте в браузере:

```
http://127.0.0.1:8080
```

### 6.1. Почему используется `NO_COLOR=true`

Если в окружении есть `NO_COLOR=1`, Trunk может завершиться ошибкой
`invalid value '1' for '--no-color'`. Значение `true` безопасно и
избавляет от этой ошибки.

## 7. Сборка без запуска сервера

Сборка полезна, когда нужны только статические файлы:

```bash
NO_COLOR=true trunk build
```

Результат будет в директории `dist/`.

## 8. Затравочная проверка (минимальная)

1. Запустите backend.
2. Запустите UI.
3. Откройте `http://127.0.0.1:8080`.
4. Убедитесь, что:
   - виден экран с формой вопроса,
   - есть блок «Статус API».

Дополнительно можно нажать кнопку «Проверить» в блоке статуса.

## 9. Настройка `API_BASE_URL`

Базовый адрес backend можно задать двумя способами:

1. **Через переменную окружения** при запуске:

```bash
API_BASE_URL=http://127.0.0.1:8000 NO_COLOR=true trunk serve --address 127.0.0.1 --port 8080
```

2. **Через интерфейс**: поле «Базовый URL API» в UI.
   Значение сохраняется в `localStorage` браузера (локальное хранилище
   настроек).

## 10. Как остановить сервер

Чтобы остановить `cargo run` или `trunk serve`, вернитесь в терминал и
нажмите:

```
Ctrl + C
```

## 11. Частые проблемы

Список типовых ошибок и решений расположен в `docs/common_issues.md`.
Если видите ошибку `Failed to fetch` и сообщение о блокировке CORS,
смотрите также `lab_materials/lab_work.md`.
